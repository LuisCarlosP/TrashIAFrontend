const w={plastic:{co2:.04,water:3,energy:.08},glass:{co2:.3,water:2,energy:.15},metal:{co2:.5,water:5,energy:.25},paper:{co2:.02,water:10,energy:.05},cardboard:{co2:.1,water:15,energy:.1},trash:{co2:0,water:0,energy:0}},y=22,i="trashia_history",l="trashia_stats",f=100,m=50,S=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,p=async t=>new Promise(e=>{const r=new FileReader;r.onload=n=>{const a=new Image;a.onload=()=>{const s=document.createElement("canvas"),o=s.getContext("2d"),c=Math.min(m/a.width,m/a.height);s.width=a.width*c,s.height=a.height*c,o?.drawImage(a,0,0,s.width,s.height),e(s.toDataURL("image/jpeg",.6))},a.src=n.target?.result},r.onerror=()=>e(""),r.readAsDataURL(t)}),g=()=>{try{const t=localStorage.getItem(i);return t?JSON.parse(t):[]}catch{return[]}},I=async(t,e,r,n)=>{const a=g();let s;n&&(s=await p(n));const o={id:S(),material:t.toLowerCase(),confidence:e,isRecyclable:r,timestamp:new Date().toISOString(),imagePreview:s};a.unshift(o);const c=a.slice(0,f);return localStorage.setItem(i,JSON.stringify(c)),u(c),o},M=t=>{const e=g().filter(r=>r.id!==t);localStorage.setItem(i,JSON.stringify(e)),u(e)},b=()=>{localStorage.removeItem(i),localStorage.removeItem(l)},D=t=>{if(t.length===0)return 0;const e=new Date;e.setHours(0,0,0,0);const r=new Set(t.map(s=>{const o=new Date(s.timestamp);return o.setHours(0,0,0,0),o.getTime()}));let n=0,a=e.getTime();for(;r.has(a);)n++,a-=1440*60*1e3;return n},E=t=>{const e=new Date;e.setHours(0,0,0,0);const r=[];for(let n=6;n>=0;n--){const a=new Date(e);a.setDate(a.getDate()-n);const s=new Date(a);s.setDate(s.getDate()+1);const o=t.filter(c=>{const d=new Date(c.timestamp);return d>=a&&d<s}).length;r.push(o)}return r},C=t=>{let e=0,r=0,n=0;return t.filter(a=>a.isRecyclable).forEach(a=>{const s=w[a.material];s&&(e+=s.co2,r+=s.water,n+=s.energy)}),{co2:Math.round(e*100)/100,water:Math.round(r*100)/100,energy:Math.round(n*100)/100,trees:Math.round(e/y*100)/100}},u=t=>{const e=h(t);localStorage.setItem(l,JSON.stringify(e))},h=t=>{const e={};let r=0,n=0;t.forEach(s=>{e[s.material]=(e[s.material]||0)+1,s.isRecyclable?r++:n++});const a=C(t);return{totalClassifications:t.length,recyclableCount:r,nonRecyclableCount:n,byMaterial:e,co2Saved:a.co2,waterSaved:a.water,energySaved:a.energy,treesEquivalent:a.trees,lastClassification:t[0]?.timestamp,streakDays:D(t),weeklyClassifications:E(t)}},R=()=>{try{const r=localStorage.getItem(l);if(r)return JSON.parse(r)}catch{}const t=g(),e=h(t);return localStorage.setItem(l,JSON.stringify(e)),e},_=(t,e="es")=>({plastic:{es:"Plástico",en:"Plastic"},glass:{es:"Vidrio",en:"Glass"},metal:{es:"Metal",en:"Metal"},paper:{es:"Papel",en:"Paper"},cardboard:{es:"Cartón",en:"Cardboard"},trash:{es:"Basura",en:"Trash"}})[t]?.[e]||t,O=t=>({plastic:"#FFC107",glass:"#4CAF50",metal:"#9E9E9E",paper:"#2196F3",cardboard:"#795548",trash:"#607D8B"})[t]||"#2e7d32",v=t=>({plastic:"fa-bottle-water",glass:"fa-wine-bottle",metal:"fa-ring",paper:"fa-file",cardboard:"fa-box",trash:"fa-trash"})[t]||"fa-recycle";export{v as a,_ as b,R as c,g as d,b as e,M as f,O as g,I as s};
