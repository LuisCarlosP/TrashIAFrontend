import{j as s,F as d,N as v,O as g,i as b,P as f,s as k,Q as w,R as D,g as u,S as H}from"./index-D6RPtZRz.js";import{r as j,L as S}from"./react-vendor-Ds61DBPd.js";import{g as N,a as C,b as p,c as M,d as L,e as R,f as T}from"./history-BqA0tBVG.js";const y=({icon:t,value:e,label:a,variant:r})=>s.jsxs("div",{className:`stat-card ${r}`,children:[s.jsx("div",{className:"stat-icon",children:s.jsx(d,{icon:t})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:e}),s.jsx("span",{className:"stat-label",children:a})]})]}),$=({materials:t,total:e,language:a,title:r})=>{const o=Object.entries(t).sort(([,l],[,i])=>i-l);return s.jsxs("section",{className:"material-section",children:[s.jsxs("h2",{children:[s.jsx(d,{icon:v}),r]}),s.jsx("div",{className:"material-chart",children:o.map(([l,i])=>{const n=Math.round(i/e*100);return s.jsxs("div",{className:"material-bar",children:[s.jsxs("div",{className:"material-info",children:[s.jsx("span",{className:"material-dot",style:{backgroundColor:N(l)}}),s.jsx("i",{className:`fas ${C(l)}`}),s.jsx("span",{className:"material-name",children:p(l,a)}),s.jsx("span",{className:"material-count",children:i})]}),s.jsx("div",{className:"bar-container",children:s.jsx("div",{className:"bar-fill",style:{width:`${n}%`,backgroundColor:N(l)}})}),s.jsxs("span",{className:"material-percentage",children:[n,"%"]})]},l)})})]})},A=({data:t,language:e,title:a})=>{const r=Math.max(...t,1),l=(()=>{const i=e==="es"?["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=[],h=new Date;for(let c=6;c>=0;c--){const m=new Date(h);m.setDate(m.getDate()-c),n.push(i[m.getDay()])}return n})();return s.jsxs("section",{className:"weekly-section",children:[s.jsxs("h2",{children:[s.jsx(d,{icon:g}),a]}),s.jsx("div",{className:"weekly-chart",children:t.map((i,n)=>s.jsxs("div",{className:"week-bar",children:[s.jsx("div",{className:"week-bar-container",children:s.jsx("div",{className:"week-bar-fill",style:{height:`${i/r*100}%`},children:i>0&&s.jsx("span",{className:"week-bar-value",children:i})})}),s.jsx("span",{className:"week-day",children:l[n]})]},n))})]})},I=({record:t,language:e,dateLabel:a,onDelete:r,deleteTitle:o})=>s.jsxs("div",{className:"history-item",children:[s.jsxs("div",{className:"history-item-left",children:[t.imagePreview?s.jsx("img",{src:t.imagePreview,alt:t.material,className:"history-thumbnail"}):s.jsx("div",{className:"history-icon",style:{backgroundColor:N(t.material)},children:s.jsx("i",{className:`fas ${C(t.material)}`})}),s.jsx("span",{className:"history-material",children:p(t.material,e)})]}),s.jsxs("div",{className:"history-item-right",children:[s.jsx("span",{className:`history-badge ${t.isRecyclable?"yes":"no"}`,children:s.jsx(d,{icon:t.isRecyclable?b:f})}),s.jsxs("span",{className:"history-confidence",children:[Math.round(t.confidence*100),"%"]}),s.jsx("span",{className:"history-date",children:a}),s.jsx("button",{className:"history-delete-btn",onClick:()=>r(t.id),title:o,children:s.jsx(d,{icon:k})})]})]}),P=({history:t,language:e,t:a,onDelete:r,onClearAll:o})=>{const[l,i]=j.useState(!1),n=c=>{const m=new Date(c),x=Math.floor((new Date().getTime()-m.getTime())/(1e3*60*60*24));return x===0?a.today:x===1?a.yesterday:x<7?`${x} ${a.daysAgo}`:m.toLocaleDateString(e==="es"?"es-ES":"en-US",{day:"numeric",month:"short"})},h=()=>{o(),i(!1)};return s.jsxs("section",{className:"history-section",children:[s.jsxs("h2",{children:[s.jsx(d,{icon:w}),a.recentHistory]}),s.jsx("div",{className:"history-list",children:t.slice(0,10).map(c=>s.jsx(I,{record:c,language:e,dateLabel:n(c.timestamp),onDelete:r,deleteTitle:a.delete},c.id))}),t.length>0&&s.jsx("div",{className:"history-actions",children:l?s.jsxs("div",{className:"confirm-dialog",children:[s.jsx("span",{children:a.clearHistoryConfirm}),s.jsx("button",{className:"btn-danger",onClick:h,children:a.delete}),s.jsx("button",{className:"btn-secondary",onClick:()=>i(!1),children:e==="es"?"Cancelar":"Cancel"})]}):s.jsxs("button",{className:"btn-danger",onClick:()=>i(!0),children:[s.jsx(d,{icon:f}),a.clearHistory]})})]})},O=({language:t,t:e})=>{const[a,r]=j.useState(null),[o,l]=j.useState([]);j.useEffect(()=>{i()},[]);const i=()=>{r(M()),l(L())},n=()=>{R(),i()},h=c=>{T(c),i()};return!a||o.length===0?s.jsx("main",{className:"stats-page",children:s.jsxs("div",{className:"stats-empty",children:[s.jsx("div",{className:"empty-icon",children:s.jsx(d,{icon:D})}),s.jsx("h2",{children:e.noHistory}),s.jsx("p",{children:e.statsSubtitle}),s.jsxs(S,{to:"/trashia",className:"btn-primary",children:[s.jsx(d,{icon:u}),e.startClassifying]})]})}):s.jsxs("main",{className:"stats-page",children:[s.jsxs("header",{className:"stats-header",children:[s.jsx("h1",{children:e.statsTitle}),s.jsx("p",{children:e.statsSubtitle})]}),s.jsxs("section",{className:"stats-grid",children:[s.jsx(y,{icon:u,value:a.totalClassifications,label:e.totalClassifications,variant:"primary"}),s.jsx(y,{icon:b,value:a.recyclableCount,label:e.recyclableItems,variant:"success"}),s.jsx(y,{icon:f,value:a.nonRecyclableCount,label:e.nonRecyclableItems,variant:"warning"}),s.jsx(y,{icon:H,value:a.streakDays,label:e.streakDays,variant:"streak"})]}),s.jsxs("div",{className:"stats-two-columns",children:[s.jsx($,{materials:a.byMaterial,total:a.totalClassifications,language:t,title:e.materialBreakdown}),s.jsx(A,{data:a.weeklyClassifications,language:t,title:e.weeklyActivity})]}),s.jsx(P,{history:o,language:t,t:{recentHistory:e.recentHistory,clearHistory:e.clearHistory,clearHistoryConfirm:e.clearHistoryConfirm,delete:e.delete,today:e.today,yesterday:e.yesterday,daysAgo:e.daysAgo},onDelete:h,onClearAll:n})]})};export{O as default};
